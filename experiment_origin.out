[INFO] main.py:198 > Set the device (cuda)
[INFO] main.py:243 > Using train-transforms Compose(
    RandomHorizontalFlip(p=0.5)
    RandomCrop(size=(32, 32), padding=4)
    ToTensor()
    Normalize(mean=(0.4914, 0.482158, 0.4465231), std=(0.247032, 0.243485, 0.2615877))
)
[INFO] augment.py:18 > cifar10: autoaugmentation is applied
[INFO] main.py:266 > Using train-transforms [AutoAugment CIFAR10 Policy]
[INFO] main.py:276 > [1] Select a CIL method (rm)
[INFO] method_manager.py:48 > CIL Scenario: 
n_tasks: 5
n_init_cls: 10
n_cls_a_task: 2
total cls: 10
[INFO] main.py:282 > [2] Incrementally training 5 tasks

##################################################
# Task 0 iteration
##################################################

[INFO] main.py:292 > [2-1] Prepare a datalist for the current task
labeled train data list 800
unlabeled train data list 10000
noisy data list 800
*batch 128
-------noisy data-------
[33mWARNING [0m [34mlogs/smh already exists[0m
batch_size : 10
[WARNING] spr_main.py:69 > logs/smh already exists
configuration:
{'data_root': './data', 'batch_size': 10, 'num_workers': 16, 'eval_batch_size': 256, 'eval_num_workers': 4, 'batch_iter': 1, 'nb_classes': 10, 'corruption_percent': 0.4, 'asymmetric_noise': False, 'x_c': 3, 'x_h': 32, 'x_w': 32, 'y_c': 10, 'device': 'cuda', 'net': 'resnet_simclr18', 'purified_buffer_size': 150, 'purified_buffer_q_poa': 0.0, 'delayed_buffer_size': 200, 'delayed_buffer_q_poa': 0.0, 'E_max': 5, 'expert_train_epochs': 40, 'expert_batch_size': 500, 'base_train_epochs': 30, 'base_batch_size': 500, 'ft_epochs': 50, 'ft_batch_size': 16, 'use_cosine_similarity': True, 'temperature': 0.5, 'projection_out_dim': 256, 'optimizer': {'type': 'Adam', 'options': {'lr': 0.0003}}, 'lr_scheduler': {'type': 'CosineAnnealingLR', 'options': {'eta_min': 0, 'last_epoch': -1}}, 'optimizer_ft': {'type': 'Adam', 'options': {'lr': 0.002}}, 'lr_scheduler_ft': {'type': 'StepLR', 'options': {'step_size': 300, 'gamma': 0.1}}, 'clip_grad': {'type': 'value', 'options': {'clip_value': 0.5}}, 'eval': True, 'data_schedule': [{'subsets': [['cifar10', 7], ['cifar10', 6]]}, {'subsets': [['cifar10', 2], ['cifar10', 3]]}, {'subsets': [['cifar10', 0], ['cifar10', 1]]}, {'subsets': [['cifar10', 5], ['cifar10', 9]]}, {'subsets': [['cifar10', 8], ['cifar10', 4]]}], 'random_seed': 0, 'log_dir': 'logs/smh'}
configuration end
config & episode saved to logs/smh
Files already downloaded and verified
Files already downloaded and verified
-------train SPR------
delay buffer full
expert training:   0%|          | 0/40 [00:00<?, ?it/s]expert training:   2%|▎         | 1/40 [00:03<02:10,  3.34s/it]expert training:   5%|▌         | 2/40 [00:04<01:16,  2.00s/it]expert training:   8%|▊         | 3/40 [00:04<00:43,  1.18s/it]expert training:  10%|█         | 4/40 [00:05<00:35,  1.00it/s]expert training:  12%|█▎        | 5/40 [00:05<00:28,  1.21it/s]expert training:  15%|█▌        | 6/40 [00:06<00:30,  1.12it/s]expert training:  18%|█▊        | 7/40 [00:07<00:31,  1.06it/s]expert training:  20%|██        | 8/40 [00:08<00:27,  1.16it/s]expert training:  22%|██▎       | 9/40 [00:09<00:22,  1.36it/s]expert training:  25%|██▌       | 10/40 [00:10<00:24,  1.22it/s]expert training:  28%|██▊       | 11/40 [00:11<00:26,  1.11it/s]expert training:  30%|███       | 12/40 [00:12<00:26,  1.06it/s]expert training:  32%|███▎      | 13/40 [00:13<00:25,  1.05it/s]expert training:  35%|███▌      | 14/40 [00:14<00:25,  1.02it/s]expert training:  38%|███▊      | 15/40 [00:15<00:24,  1.01it/s]expert training:  40%|████      | 16/40 [00:16<00:24,  1.02s/it]expert training:  42%|████▎     | 17/40 [00:17<00:23,  1.04s/it]expert training:  45%|████▌     | 18/40 [00:18<00:23,  1.07s/it]expert training:  48%|████▊     | 19/40 [00:19<00:22,  1.07s/it]expert training:  50%|█████     | 20/40 [00:20<00:18,  1.06it/s]expert training:  52%|█████▎    | 21/40 [00:20<00:14,  1.27it/s]expert training:  55%|█████▌    | 22/40 [00:20<00:10,  1.70it/s]expert training:  57%|█████▊    | 23/40 [00:21<00:11,  1.44it/s]expert training:  60%|██████    | 24/40 [00:21<00:08,  1.92it/s]expert training:  62%|██████▎   | 25/40 [00:22<00:09,  1.52it/s]expert training:  65%|██████▌   | 26/40 [00:23<00:09,  1.55it/s]expert training:  68%|██████▊   | 27/40 [00:23<00:07,  1.68it/s]expert training:  70%|███████   | 28/40 [00:24<00:05,  2.24it/s]expert training:  72%|███████▎  | 29/40 [00:25<00:08,  1.27it/s]expert training:  75%|███████▌  | 30/40 [00:26<00:07,  1.40it/s]expert training:  78%|███████▊  | 31/40 [00:27<00:07,  1.23it/s]expert training:  80%|████████  | 32/40 [00:27<00:04,  1.66it/s]expert training:  82%|████████▎ | 33/40 [00:28<00:05,  1.38it/s]expert training:  85%|████████▌ | 34/40 [00:29<00:04,  1.21it/s]expert training:  90%|█████████ | 36/40 [00:30<00:02,  1.40it/s]expert training:  92%|█████████▎| 37/40 [00:31<00:02,  1.24it/s]expert training:  98%|█████████▊| 39/40 [00:32<00:00,  1.41it/s]expert training: 100%|██████████| 40/40 [00:32<00:00,  1.74it/s]                                                                total_train_epoch 40 epoch_i 0
total_train_epoch 40 epoch_i 1
total_train_epoch 40 epoch_i 2
total_train_epoch 40 epoch_i 3
total_train_epoch 40 epoch_i 4
total_train_epoch 40 epoch_i 5
total_train_epoch 40 epoch_i 6
total_train_epoch 40 epoch_i 7
total_train_epoch 40 epoch_i 8
total_train_epoch 40 epoch_i 9
total_train_epoch 40 epoch_i 10
total_train_epoch 40 epoch_i 11
total_train_epoch 40 epoch_i 12
total_train_epoch 40 epoch_i 13
total_train_epoch 40 epoch_i 14
total_train_epoch 40 epoch_i 15
total_train_epoch 40 epoch_i 16
total_train_epoch 40 epoch_i 17
total_train_epoch 40 epoch_i 18
total_train_epoch 40 epoch_i 19
total_train_epoch 40 epoch_i 20
total_train_epoch 40 epoch_i 21
total_train_epoch 40 epoch_i 22
total_train_epoch 40 epoch_i 23
total_train_epoch 40 epoch_i 24
total_train_epoch 40 epoch_i 25
total_train_epoch 40 epoch_i 26
total_train_epoch 40 epoch_i 27
total_train_epoch 40 epoch_i 28
total_train_epoch 40 epoch_i 29
total_train_epoch 40 epoch_i 30
total_train_epoch 40 epoch_i 31
total_train_epoch 40 epoch_i 32
total_train_epoch 40 epoch_i 33
total_train_epoch 40 epoch_i 34
total_train_epoch 40 epoch_i 35
total_train_epoch 40 epoch_i 36
total_train_epoch 40 epoch_i 37
total_train_epoch 40 epoch_i 38
total_train_epoch 40 epoch_i 39
base training:   0%|          | 0/30 [00:00<?, ?it/s]base training:   3%|▎         | 1/30 [00:01<00:29,  1.02s/it]base training:   7%|▋         | 2/30 [00:02<00:28,  1.03s/it]base training:  10%|█         | 3/30 [00:02<00:16,  1.60it/s]base training:  13%|█▎        | 4/30 [00:03<00:20,  1.25it/s]base training:  17%|█▋        | 5/30 [00:03<00:13,  1.81it/s]base training:  20%|██        | 6/30 [00:04<00:16,  1.47it/s]base training:  23%|██▎       | 7/30 [00:04<00:15,  1.52it/s]base training:  27%|██▋       | 8/30 [00:05<00:12,  1.73it/s]base training:  30%|███       | 9/30 [00:06<00:15,  1.38it/s]base training:  33%|███▎      | 10/30 [00:06<00:10,  1.88it/s]base training:  37%|███▋      | 11/30 [00:07<00:12,  1.52it/s]base training:  40%|████      | 12/30 [00:08<00:11,  1.51it/s]base training:  43%|████▎     | 13/30 [00:08<00:10,  1.61it/s]base training:  47%|████▋     | 14/30 [00:09<00:11,  1.34it/s]base training:  50%|█████     | 15/30 [00:10<00:12,  1.18it/s]base training:  53%|█████▎    | 16/30 [00:11<00:12,  1.08it/s]base training:  57%|█████▋    | 17/30 [00:12<00:12,  1.03it/s]base training:  60%|██████    | 18/30 [00:13<00:11,  1.05it/s]base training:  63%|██████▎   | 19/30 [00:14<00:08,  1.35it/s]base training:  67%|██████▋   | 20/30 [00:15<00:08,  1.21it/s]base training:  70%|███████   | 21/30 [00:16<00:08,  1.08it/s]base training:  73%|███████▎  | 22/30 [00:17<00:07,  1.02it/s]base training:  77%|███████▋  | 23/30 [00:18<00:06,  1.01it/s]base training:  80%|████████  | 24/30 [00:19<00:06,  1.03s/it]base training:  83%|████████▎ | 25/30 [00:20<00:05,  1.00s/it]base training:  87%|████████▋ | 26/30 [00:20<00:03,  1.31it/s]base training:  90%|█████████ | 27/30 [00:21<00:02,  1.21it/s]base training:  93%|█████████▎| 28/30 [00:22<00:01,  1.14it/s]base training:  97%|█████████▋| 29/30 [00:22<00:00,  1.48it/s]base training: 100%|██████████| 30/30 [00:23<00:00,  1.28it/s]                                                              ***********************************************
unique [1, 9]
class: 1
--- num of selected samples: 59
--- num of selected corrupt samples: 0.0
class: 9
--- num of selected samples: 34
--- num of selected corrupt samples: 34.0
***********************************************
clean_idx_len 93
[1, 2, 3, 7, 11, 12, 19, 30, 37, 38, 44, 45, 46, 48, 53, 57, 59, 62, 63, 64, 65, 70, 72, 74, 75, 76, 78, 80, 85, 87, 88, 91, 94, 95, 97, 102, 103, 111, 115, 119, 122, 123, 132, 135, 142, 151, 157, 158, 159, 164, 166, 168, 170, 176, 177, 182, 184, 190, 194, 0, 5, 6, 22, 24, 25, 26, 36, 39, 42, 43, 47, 49, 55, 71, 81, 106, 107, 128, 130, 131, 139, 140, 144, 146, 148, 150, 153, 156, 163, 173, 187, 188, 199]
clean_p
tensor([0.7067, 0.9463, 0.7162, 0.4444, 0.0484, 0.2878, 0.5873, 0.1073, 0.6370,
        0.9073, 0.8989, 0.9498, 0.6998, 0.8421, 0.1587, 0.2995, 0.5505, 0.4973,
        0.8035, 0.9415, 0.2811, 0.9709, 0.3124, 0.2689, 0.3463, 1.0000, 0.7527,
        1.0000, 0.9522, 0.8950, 0.3945, 0.9598, 0.7745, 0.8425, 0.9738, 0.7715,
        0.6690, 0.8127, 0.7788, 0.8246, 0.8804, 0.6784, 0.9459, 0.9638, 0.0688,
        0.8742, 0.8126, 0.8206, 0.3875, 0.5808, 0.7402, 0.9631, 0.9273, 0.7364,
        0.8358, 0.5210, 0.2145, 0.3482, 0.9141, 0.8915, 0.6671, 0.6799, 0.8831,
        0.8859, 0.7430, 0.3969, 0.6970, 0.4011, 0.3716, 0.4016, 0.4361, 0.5065,
        0.9054, 0.8882, 0.7530, 0.8862, 0.8758, 0.4063, 0.4726, 0.2782, 0.9038,
        0.8845, 0.6424, 0.8876, 0.6905, 0.7666, 0.8572, 0.3659, 0.5375, 0.3994,
        0.9053, 0.8722, 0.4765])
purified buffer update!!
#normal data: 59.0, 	 #corrupted data: 34.0
buffer_corrupts tensor(34.)
delay buffer full
expert training:   0%|          | 0/40 [00:00<?, ?it/s]expert training:   2%|▎         | 1/40 [00:00<00:36,  1.06it/s]expert training:   5%|▌         | 2/40 [00:02<00:39,  1.04s/it]expert training:   8%|▊         | 3/40 [00:03<00:38,  1.05s/it]expert training:  10%|█         | 4/40 [00:04<00:38,  1.07s/it]expert training:  12%|█▎        | 5/40 [00:05<00:37,  1.08s/it]expert training:  15%|█▌        | 6/40 [00:06<00:37,  1.09s/it]expert training:  18%|█▊        | 7/40 [00:07<00:35,  1.08s/it]expert training:  20%|██        | 8/40 [00:08<00:30,  1.06it/s]expert training:  22%|██▎       | 9/40 [00:08<00:25,  1.22it/s]expert training:  25%|██▌       | 10/40 [00:09<00:23,  1.27it/s]expert training:  28%|██▊       | 11/40 [00:12<00:42,  1.46s/it]expert training:  30%|███       | 12/40 [00:12<00:30,  1.08s/it]expert training:  32%|███▎      | 13/40 [00:13<00:28,  1.07s/it]expert training:  35%|███▌      | 14/40 [00:14<00:27,  1.06s/it]expert training:  38%|███▊      | 15/40 [00:15<00:27,  1.09s/it]expert training:  40%|████      | 16/40 [00:16<00:26,  1.08s/it]expert training:  42%|████▎     | 17/40 [00:17<00:22,  1.04it/s]expert training:  45%|████▌     | 18/40 [00:18<00:18,  1.19it/s]expert training:  48%|████▊     | 19/40 [00:19<00:18,  1.11it/s]expert training:  50%|█████     | 20/40 [00:19<00:16,  1.20it/s]expert training:  52%|█████▎    | 21/40 [00:20<00:14,  1.34it/s]expert training:  55%|█████▌    | 22/40 [00:21<00:14,  1.21it/s]expert training:  57%|█████▊    | 23/40 [00:22<00:13,  1.28it/s]expert training:  60%|██████    | 24/40 [00:22<00:11,  1.41it/s]expert training:  62%|██████▎   | 25/40 [00:23<00:12,  1.25it/s]expert training:  65%|██████▌   | 26/40 [00:24<00:12,  1.15it/s]expert training:  68%|██████▊   | 27/40 [00:25<00:12,  1.06it/s]expert training:  70%|███████   | 28/40 [00:26<00:11,  1.03it/s]expert training:  72%|███████▎  | 29/40 [00:27<00:11,  1.02s/it]expert training:  75%|███████▌  | 30/40 [00:29<00:10,  1.04s/it]expert training:  78%|███████▊  | 31/40 [00:30<00:09,  1.06s/it]expert training:  80%|████████  | 32/40 [00:31<00:08,  1.05s/it]expert training:  82%|████████▎ | 33/40 [00:32<00:07,  1.05s/it]expert training:  85%|████████▌ | 34/40 [00:33<00:06,  1.05s/it]expert training:  88%|████████▊ | 35/40 [00:33<00:04,  1.08it/s]expert training:  90%|█████████ | 36/40 [00:34<00:03,  1.25it/s]expert training:  92%|█████████▎| 37/40 [00:35<00:02,  1.17it/s]expert training:  95%|█████████▌| 38/40 [00:36<00:01,  1.26it/s]expert training:  98%|█████████▊| 39/40 [00:37<00:00,  1.17it/s]expert training: 100%|██████████| 40/40 [00:37<00:00,  1.33it/s]                                                                total_train_epoch 40 epoch_i 0
total_train_epoch 40 epoch_i 1
total_train_epoch 40 epoch_i 2
total_train_epoch 40 epoch_i 3
total_train_epoch 40 epoch_i 4
total_train_epoch 40 epoch_i 5
total_train_epoch 40 epoch_i 6
total_train_epoch 40 epoch_i 7
total_train_epoch 40 epoch_i 8
total_train_epoch 40 epoch_i 9
total_train_epoch 40 epoch_i 10
total_train_epoch 40 epoch_i 11
total_train_epoch 40 epoch_i 12
total_train_epoch 40 epoch_i 13
total_train_epoch 40 epoch_i 14
total_train_epoch 40 epoch_i 15
total_train_epoch 40 epoch_i 16
total_train_epoch 40 epoch_i 17
total_train_epoch 40 epoch_i 18
total_train_epoch 40 epoch_i 19
total_train_epoch 40 epoch_i 20
total_train_epoch 40 epoch_i 21
total_train_epoch 40 epoch_i 22
total_train_epoch 40 epoch_i 23
total_train_epoch 40 epoch_i 24
total_train_epoch 40 epoch_i 25
total_train_epoch 40 epoch_i 26
total_train_epoch 40 epoch_i 27
total_train_epoch 40 epoch_i 28
total_train_epoch 40 epoch_i 29
total_train_epoch 40 epoch_i 30
total_train_epoch 40 epoch_i 31
total_train_epoch 40 epoch_i 32
total_train_epoch 40 epoch_i 33
total_train_epoch 40 epoch_i 34
total_train_epoch 40 epoch_i 35
total_train_epoch 40 epoch_i 36
total_train_epoch 40 epoch_i 37
total_train_epoch 40 epoch_i 38
total_train_epoch 40 epoch_i 39
base training:   0%|          | 0/30 [00:00<?, ?it/s]base training:   3%|▎         | 1/30 [00:01<00:57,  1.99s/it]base training:   7%|▋         | 2/30 [00:02<00:35,  1.27s/it]base training:  10%|█         | 3/30 [00:03<00:25,  1.08it/s]base training:  13%|█▎        | 4/30 [00:04<00:25,  1.01it/s]base training:  17%|█▋        | 5/30 [00:05<00:25,  1.03s/it]base training:  20%|██        | 6/30 [00:06<00:25,  1.04s/it]base training:  23%|██▎       | 7/30 [00:07<00:24,  1.05s/it]base training:  27%|██▋       | 8/30 [00:07<00:16,  1.33it/s]base training:  30%|███       | 9/30 [00:08<00:17,  1.20it/s]base training:  33%|███▎      | 10/30 [00:09<00:17,  1.12it/s]base training:  37%|███▋      | 11/30 [00:09<00:12,  1.53it/s]base training:  40%|████      | 12/30 [00:10<00:13,  1.32it/s]base training:  43%|████▎     | 13/30 [00:10<00:09,  1.78it/s]base training:  47%|████▋     | 14/30 [00:11<00:11,  1.45it/s]base training:  50%|█████     | 15/30 [00:12<00:11,  1.27it/s]base training:  53%|█████▎    | 16/30 [00:13<00:09,  1.42it/s]base training:  57%|█████▋    | 17/30 [00:14<00:08,  1.52it/s]base training:  60%|██████    | 18/30 [00:15<00:09,  1.31it/s]base training:  63%|██████▎   | 19/30 [00:15<00:06,  1.75it/s]base training:  67%|██████▋   | 20/30 [00:16<00:07,  1.39it/s]base training:  70%|███████   | 21/30 [00:17<00:07,  1.23it/s]base training:  73%|███████▎  | 22/30 [00:17<00:04,  1.67it/s]base training:  77%|███████▋  | 23/30 [00:18<00:04,  1.41it/s]base training:  80%|████████  | 24/30 [00:18<00:04,  1.48it/s]base training:  83%|████████▎ | 25/30 [00:19<00:03,  1.65it/s]base training:  87%|████████▋ | 26/30 [00:20<00:02,  1.59it/s]base training:  90%|█████████ | 27/30 [00:20<00:01,  1.73it/s]base training:  93%|█████████▎| 28/30 [00:21<00:01,  1.40it/s]base training:  97%|█████████▋| 29/30 [00:21<00:00,  1.85it/s]base training: 100%|██████████| 30/30 [00:22<00:00,  1.51it/s]                                                              ***********************************************
unique [1, 9]
class: 1
--- num of selected samples: 65
--- num of selected corrupt samples: 0.0
class: 9
--- num of selected samples: 49
--- num of selected corrupt samples: 49.0
***********************************************
clean_idx_len 114
[5, 15, 20, 22, 23, 34, 37, 39, 41, 44, 45, 46, 48, 49, 51, 57, 60, 69, 72, 80, 82, 87, 88, 89, 91, 97, 100, 103, 108, 110, 115, 117, 119, 120, 121, 125, 126, 129, 133, 136, 138, 140, 143, 146, 147, 148, 149, 150, 152, 154, 155, 164, 165, 166, 170, 171, 174, 175, 177, 183, 184, 188, 193, 194, 196, 1, 7, 8, 10, 16, 25, 27, 32, 36, 43, 53, 58, 63, 64, 67, 73, 75, 76, 77, 79, 84, 94, 96, 98, 106, 107, 109, 111, 113, 123, 127, 130, 134, 135, 137, 142, 144, 145, 156, 157, 158, 159, 160, 168, 173, 179, 182, 191, 195]
clean_p
tensor([0.9426, 0.9197, 0.7223, 0.8868, 0.5238, 0.4069, 0.6394, 0.8561, 0.7518,
        0.6907, 0.4936, 0.6039, 0.8616, 0.7244, 0.7512, 0.9642, 0.9367, 0.7436,
        0.7160, 0.5387, 0.8894, 0.7245, 0.8598, 0.3434, 0.8030, 0.5528, 0.7269,
        0.8055, 0.5341, 0.5329, 0.8947, 0.4843, 0.5718, 0.7873, 0.9624, 0.4152,
        0.5156, 0.6277, 0.9039, 0.8859, 0.6150, 0.5610, 0.5680, 0.3908, 0.7303,
        0.5377, 0.9642, 0.5133, 0.4734, 0.8123, 0.8191, 0.8184, 0.7188, 0.3739,
        0.8880, 0.6625, 0.5007, 0.6333, 0.7844, 0.5541, 0.7936, 0.5962, 0.8758,
        0.8600, 0.9470, 0.8258, 0.6390, 0.8258, 0.7504, 0.8111, 0.8182, 0.8237,
        0.7383, 0.7789, 0.8258, 0.8228, 0.8258, 0.4310, 0.7649, 0.7521, 0.8244,
        0.8238, 0.6938, 0.8142, 0.8258, 0.8138, 0.5402, 0.7156, 0.8240, 0.8123,
        0.8257, 0.8203, 0.8181, 0.8005, 0.8064, 0.8051, 0.5584, 0.8054, 0.8221,
        0.8186, 0.8222, 0.7810, 0.8002, 0.8258, 0.7936, 0.8250, 0.7490, 0.7315,
        0.8018, 0.5846, 0.4662, 0.8243, 0.8211, 0.7568])
purified buffer update!!
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 77.33333333333333
before 77.33333333333333
after 76.66666666666667
before 76.66666666666667
after 76.0
before 76.0
after 75.33333333333333
before 75.33333333333333
after 74.66666666666667
before 74.66666666666667
after 74.0
before 74.0
after 73.33333333333333
before 73.33333333333333
after 72.66666666666667
before 72.66666666666667
after 72.0
before 72.0
after 71.33333333333333
before 71.33333333333333
after 70.66666666666667
before 70.66666666666667
after 70.0
before 70.0
after 69.33333333333333
before 69.33333333333333
after 68.66666666666667
before 68.66666666666667
after 68.0
before 68.0
after 67.33333333333333
before 67.33333333333333
after 66.66666666666667
before 66.66666666666667
after 66.0
before 66.0
after 65.33333333333333
before 65.33333333333333
after 64.66666666666667
before 64.66666666666667
after 64.0
before 64.0
after 63.333333333333336
before 63.333333333333336
after 62.666666666666664
before 62.666666666666664
after 62.0
before 62.0
after 61.333333333333336
before 61.333333333333336
after 60.666666666666664
before 60.666666666666664
after 60.0
before 60.0
after 59.333333333333336
before 59.333333333333336
after 58.666666666666664
before 58.666666666666664
after 58.0
before 58.0
after 57.333333333333336
before 57.333333333333336
after 56.666666666666664
before 56.666666666666664
after 56.0
before 56.0
after 55.333333333333336
before 55.333333333333336
after 54.666666666666664
before 54.666666666666664
after 54.0
before 54.0
after 53.333333333333336
before 53.333333333333336
after 52.666666666666664
before 52.666666666666664
after 52.0
before 52.0
after 51.333333333333336
before 51.333333333333336
after 50.666666666666664
before 50.666666666666664
after 50.0
before 50.0
after 50.0
before 50.0
after 49.333333333333336
before 49.333333333333336
after 49.333333333333336
before 49.333333333333336
after 49.333333333333336
before 49.333333333333336
after 49.333333333333336
before 49.333333333333336
after 49.333333333333336
before 49.333333333333336
after 49.333333333333336
before 49.333333333333336
after 48.666666666666664
#normal data: 73.0, 	 #corrupted data: 77.0
buffer_corrupts tensor(77.)
delay buffer full
expert training:   0%|          | 0/40 [00:00<?, ?it/s]expert training:   2%|▎         | 1/40 [00:00<00:32,  1.20it/s]expert training:   5%|▌         | 2/40 [00:01<00:37,  1.01it/s]expert training:   8%|▊         | 3/40 [00:03<00:38,  1.05s/it]expert training:  10%|█         | 4/40 [00:03<00:31,  1.13it/s]expert training:  12%|█▎        | 5/40 [00:04<00:26,  1.32it/s]expert training:  15%|█▌        | 6/40 [00:05<00:29,  1.15it/s]expert training:  18%|█▊        | 7/40 [00:06<00:30,  1.08it/s]expert training:  20%|██        | 8/40 [00:07<00:30,  1.04it/s]expert training:  22%|██▎       | 9/40 [00:08<00:30,  1.01it/s]expert training:  25%|██▌       | 10/40 [00:09<00:30,  1.01s/it]expert training:  28%|██▊       | 11/40 [00:10<00:30,  1.04s/it]expert training:  30%|███       | 12/40 [00:11<00:26,  1.08it/s]expert training:  32%|███▎      | 13/40 [00:11<00:21,  1.24it/s]expert training:  35%|███▌      | 14/40 [00:12<00:22,  1.14it/s]expert training:  38%|███▊      | 15/40 [00:13<00:23,  1.06it/s]expert training:  40%|████      | 16/40 [00:15<00:23,  1.02it/s]expert training:  42%|████▎     | 17/40 [00:15<00:20,  1.12it/s]expert training:  45%|████▌     | 18/40 [00:16<00:17,  1.27it/s]expert training:  48%|████▊     | 19/40 [00:17<00:18,  1.16it/s]expert training:  50%|█████     | 20/40 [00:18<00:18,  1.09it/s]expert training:  52%|█████▎    | 21/40 [00:18<00:15,  1.19it/s]expert training:  55%|█████▌    | 22/40 [00:19<00:15,  1.13it/s]expert training:  57%|█████▊    | 23/40 [00:20<00:13,  1.28it/s]expert training:  60%|██████    | 24/40 [00:21<00:13,  1.17it/s]expert training:  62%|██████▎   | 25/40 [00:22<00:14,  1.07it/s]expert training:  65%|██████▌   | 26/40 [00:23<00:13,  1.03it/s]expert training:  68%|██████▊   | 27/40 [00:24<00:11,  1.12it/s]expert training:  70%|███████   | 28/40 [00:24<00:09,  1.27it/s]expert training:  72%|███████▎  | 29/40 [00:26<00:09,  1.14it/s]expert training:  75%|███████▌  | 30/40 [00:26<00:08,  1.20it/s]expert training:  78%|███████▊  | 31/40 [00:27<00:06,  1.34it/s]expert training:  80%|████████  | 32/40 [00:28<00:06,  1.18it/s]expert training:  82%|████████▎ | 33/40 [00:29<00:05,  1.22it/s]expert training:  85%|████████▌ | 34/40 [00:29<00:04,  1.38it/s]expert training:  88%|████████▊ | 35/40 [00:30<00:04,  1.21it/s]expert training:  90%|█████████ | 36/40 [00:31<00:03,  1.10it/s]expert training:  92%|█████████▎| 37/40 [00:32<00:02,  1.02it/s]expert training:  95%|█████████▌| 38/40 [00:33<00:01,  1.00it/s]expert training:  98%|█████████▊| 39/40 [00:34<00:00,  1.09it/s]expert training: 100%|██████████| 40/40 [00:35<00:00,  1.26it/s]                                                                total_train_epoch 40 epoch_i 0
total_train_epoch 40 epoch_i 1
total_train_epoch 40 epoch_i 2
total_train_epoch 40 epoch_i 3
total_train_epoch 40 epoch_i 4
total_train_epoch 40 epoch_i 5
total_train_epoch 40 epoch_i 6
total_train_epoch 40 epoch_i 7
total_train_epoch 40 epoch_i 8
total_train_epoch 40 epoch_i 9
total_train_epoch 40 epoch_i 10
total_train_epoch 40 epoch_i 11
total_train_epoch 40 epoch_i 12
total_train_epoch 40 epoch_i 13
total_train_epoch 40 epoch_i 14
total_train_epoch 40 epoch_i 15
total_train_epoch 40 epoch_i 16
total_train_epoch 40 epoch_i 17
total_train_epoch 40 epoch_i 18
total_train_epoch 40 epoch_i 19
total_train_epoch 40 epoch_i 20
total_train_epoch 40 epoch_i 21
total_train_epoch 40 epoch_i 22
total_train_epoch 40 epoch_i 23
total_train_epoch 40 epoch_i 24
total_train_epoch 40 epoch_i 25
total_train_epoch 40 epoch_i 26
total_train_epoch 40 epoch_i 27
total_train_epoch 40 epoch_i 28
total_train_epoch 40 epoch_i 29
total_train_epoch 40 epoch_i 30
total_train_epoch 40 epoch_i 31
total_train_epoch 40 epoch_i 32
total_train_epoch 40 epoch_i 33
total_train_epoch 40 epoch_i 34
total_train_epoch 40 epoch_i 35
total_train_epoch 40 epoch_i 36
total_train_epoch 40 epoch_i 37
total_train_epoch 40 epoch_i 38
total_train_epoch 40 epoch_i 39
base training:   0%|          | 0/30 [00:00<?, ?it/s]base training:   3%|▎         | 1/30 [00:01<00:32,  1.12s/it]base training:   7%|▋         | 2/30 [00:02<00:31,  1.13s/it]base training:  10%|█         | 3/30 [00:03<00:30,  1.14s/it]base training:  13%|█▎        | 4/30 [00:04<00:29,  1.15s/it]base training:  17%|█▋        | 5/30 [00:05<00:28,  1.14s/it]base training:  20%|██        | 6/30 [00:06<00:27,  1.15s/it]base training:  23%|██▎       | 7/30 [00:08<00:26,  1.14s/it]base training:  27%|██▋       | 8/30 [00:09<00:24,  1.13s/it]base training:  30%|███       | 9/30 [00:10<00:23,  1.12s/it]base training:  33%|███▎      | 10/30 [00:11<00:22,  1.11s/it]base training:  37%|███▋      | 11/30 [00:12<00:21,  1.12s/it]base training:  40%|████      | 12/30 [00:13<00:20,  1.13s/it]base training:  43%|████▎     | 13/30 [00:14<00:19,  1.13s/it]base training:  47%|████▋     | 14/30 [00:15<00:17,  1.12s/it]base training:  50%|█████     | 15/30 [00:16<00:16,  1.13s/it]base training:  53%|█████▎    | 16/30 [00:18<00:15,  1.13s/it]base training:  57%|█████▋    | 17/30 [00:19<00:14,  1.15s/it]base training:  60%|██████    | 18/30 [00:20<00:13,  1.15s/it]base training:  63%|██████▎   | 19/30 [00:21<00:12,  1.13s/it]base training:  67%|██████▋   | 20/30 [00:22<00:11,  1.14s/it]base training:  70%|███████   | 21/30 [00:23<00:09,  1.11s/it]base training:  73%|███████▎  | 22/30 [00:24<00:08,  1.01s/it]base training:  77%|███████▋  | 23/30 [00:25<00:07,  1.09s/it]base training:  80%|████████  | 24/30 [00:26<00:06,  1.01s/it]base training:  83%|████████▎ | 25/30 [00:27<00:04,  1.16it/s]base training:  87%|████████▋ | 26/30 [00:28<00:03,  1.08it/s]base training:  90%|█████████ | 27/30 [00:29<00:02,  1.02it/s]base training:  93%|█████████▎| 28/30 [00:30<00:02,  1.03s/it]base training:  97%|█████████▋| 29/30 [00:31<00:01,  1.05s/it]base training: 100%|██████████| 30/30 [00:32<00:00,  1.08s/it]                                                              ***********************************************
unique [1, 9]
class: 1
--- num of selected samples: 33
--- num of selected corrupt samples: 33.0
class: 9
--- num of selected samples: 63
--- num of selected corrupt samples: 0.0
***********************************************
clean_idx_len 96
[6, 11, 13, 15, 35, 38, 44, 46, 68, 70, 82, 85, 87, 92, 93, 103, 114, 123, 129, 132, 133, 140, 147, 149, 153, 164, 165, 171, 176, 182, 186, 187, 197, 0, 1, 3, 5, 16, 19, 20, 22, 24, 27, 30, 31, 32, 36, 45, 47, 49, 57, 60, 61, 62, 64, 65, 71, 72, 73, 76, 77, 79, 81, 83, 84, 100, 105, 106, 108, 109, 112, 113, 119, 120, 126, 127, 128, 131, 134, 138, 151, 156, 157, 162, 166, 167, 168, 170, 174, 175, 178, 179, 181, 184, 190, 194]
clean_p
tensor([0.8315, 0.7224, 0.6691, 0.6131, 0.8972, 0.8479, 0.8920, 0.7669, 0.8306,
        0.8284, 0.8309, 0.9110, 0.8407, 0.6458, 0.4739, 0.8602, 0.8862, 0.1215,
        0.8279, 0.8381, 0.8236, 0.8813, 0.6846, 0.8429, 0.7921, 0.7946, 0.8055,
        0.4482, 0.1756, 0.8322, 0.9147, 0.7141, 0.8546, 0.8924, 0.9748, 0.9985,
        0.9843, 0.9891, 0.0543, 0.9882, 0.6147, 0.9821, 0.9977, 1.0000, 0.9813,
        0.3518, 0.4014, 0.8515, 0.9987, 0.0818, 0.0150, 0.9852, 0.9993, 0.9928,
        0.8969, 0.2443, 0.9983, 0.9420, 0.9388, 0.5342, 0.9840, 0.9330, 0.9943,
        0.9905, 0.9716, 0.9987, 0.7318, 0.9990, 0.9124, 0.9999, 0.9984, 0.9995,
        0.8533, 0.4828, 0.2478, 0.9978, 0.9992, 0.9996, 0.0773, 0.0814, 0.9923,
        0.9194, 0.0119, 0.1129, 0.8543, 0.9903, 0.2737, 0.9989, 0.9875, 0.1254,
        0.9783, 0.9966, 0.3259, 0.8322, 0.2227, 0.1130])
purified buffer update!!
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 48.0
before 48.0
after 47.333333333333336
before 47.333333333333336
after 47.333333333333336
before 47.333333333333336
after 47.333333333333336
before 47.333333333333336
after 47.333333333333336
before 47.333333333333336
after 46.666666666666664
before 46.666666666666664
after 46.0
before 46.0
after 46.0
before 46.0
after 46.0
before 46.0
after 45.333333333333336
before 45.333333333333336
after 45.333333333333336
before 45.333333333333336
after 45.333333333333336
before 45.333333333333336
after 45.333333333333336
before 45.333333333333336
after 44.666666666666664
before 44.666666666666664
after 44.666666666666664
before 44.666666666666664
after 44.0
before 44.0
after 44.0
before 44.0
after 43.333333333333336
before 43.333333333333336
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.666666666666664
before 42.666666666666664
after 42.0
before 42.0
after 42.0
before 42.0
after 42.0
before 42.0
after 42.666666666666664
before 42.666666666666664
after 43.333333333333336
before 43.333333333333336
after 43.333333333333336
before 43.333333333333336
after 44.0
before 44.0
after 44.0
before 44.0
after 44.0
before 44.0
after 44.666666666666664
before 44.666666666666664
after 45.333333333333336
before 45.333333333333336
after 46.0
before 46.0
after 46.666666666666664
before 46.666666666666664
after 47.333333333333336
before 47.333333333333336
after 47.333333333333336
before 47.333333333333336
after 47.333333333333336
before 47.333333333333336
after 48.0
before 48.0
after 48.666666666666664
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 48.666666666666664
before 48.666666666666664
after 49.333333333333336
before 49.333333333333336
after 50.0
before 50.0
after 50.666666666666664
before 50.666666666666664
after 50.666666666666664
before 50.666666666666664
after 51.333333333333336
before 51.333333333333336
after 52.0
before 52.0
after 52.666666666666664
before 52.666666666666664
after 52.666666666666664
before 52.666666666666664
after 52.666666666666664
before 52.666666666666664
after 52.666666666666664
before 52.666666666666664
after 53.333333333333336
before 53.333333333333336
after 54.0
before 54.0
after 54.666666666666664
before 54.666666666666664
after 55.333333333333336
before 55.333333333333336
after 55.333333333333336
before 55.333333333333336
after 56.0
before 56.0
after 56.666666666666664
before 56.666666666666664
after 57.333333333333336
before 57.333333333333336
after 58.0
before 58.0
after 58.666666666666664
before 58.666666666666664
after 59.333333333333336
before 59.333333333333336
after 59.333333333333336
before 59.333333333333336
after 60.0
before 60.0
after 60.0
before 60.0
after 60.666666666666664
before 60.666666666666664
after 61.333333333333336
before 61.333333333333336
after 61.333333333333336
before 61.333333333333336
after 62.0
before 62.0
after 62.0
before 62.0
after 62.666666666666664
before 62.666666666666664
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 64.0
before 64.0
after 64.0
before 64.0
after 64.66666666666667
before 64.66666666666667
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 66.0
before 66.0
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
#normal data: 101.0, 	 #corrupted data: 49.0
buffer_corrupts tensor(49.)
delay buffer full
expert training:   0%|          | 0/40 [00:00<?, ?it/s]expert training:   2%|▎         | 1/40 [00:00<00:24,  1.62it/s]expert training:   5%|▌         | 2/40 [00:01<00:32,  1.18it/s]expert training:   8%|▊         | 3/40 [00:01<00:19,  1.93it/s]expert training:  10%|█         | 4/40 [00:02<00:26,  1.36it/s]expert training:  15%|█▌        | 6/40 [00:03<00:21,  1.55it/s]expert training:  18%|█▊        | 7/40 [00:04<00:16,  1.99it/s]expert training:  20%|██        | 8/40 [00:05<00:23,  1.36it/s]expert training:  22%|██▎       | 9/40 [00:06<00:22,  1.37it/s]expert training:  25%|██▌       | 10/40 [00:06<00:16,  1.82it/s]expert training:  28%|██▊       | 11/40 [00:07<00:20,  1.45it/s]expert training:  32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]expert training:  38%|███▊      | 15/40 [00:09<00:15,  1.64it/s]expert training:  42%|████▎     | 17/40 [00:10<00:13,  1.69it/s]expert training:  48%|████▊     | 19/40 [00:11<00:12,  1.71it/s]expert training:  50%|█████     | 20/40 [00:12<00:11,  1.67it/s]expert training:  52%|█████▎    | 21/40 [00:12<00:10,  1.77it/s]expert training:  55%|█████▌    | 22/40 [00:13<00:08,  2.19it/s]expert training:  57%|█████▊    | 23/40 [00:13<00:09,  1.70it/s]expert training:  62%|██████▎   | 25/40 [00:15<00:08,  1.74it/s]expert training:  65%|██████▌   | 26/40 [00:15<00:06,  2.14it/s]expert training:  68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s]expert training:  70%|███████   | 28/40 [00:16<00:05,  2.13it/s]expert training:  72%|███████▎  | 29/40 [00:17<00:06,  1.63it/s]expert training:  75%|███████▌  | 30/40 [00:18<00:07,  1.39it/s]expert training:  78%|███████▊  | 31/40 [00:18<00:04,  1.82it/s]expert training:  80%|████████  | 32/40 [00:19<00:05,  1.51it/s]expert training:  82%|████████▎ | 33/40 [00:20<00:05,  1.32it/s]expert training:  85%|████████▌ | 34/40 [00:20<00:03,  1.70it/s]expert training:  88%|████████▊ | 35/40 [00:21<00:03,  1.43it/s]expert training:  90%|█████████ | 36/40 [00:22<00:03,  1.25it/s]expert training:  92%|█████████▎| 37/40 [00:23<00:02,  1.30it/s]expert training:  95%|█████████▌| 38/40 [00:24<00:01,  1.20it/s]expert training:  98%|█████████▊| 39/40 [00:24<00:00,  1.35it/s]expert training: 100%|██████████| 40/40 [00:25<00:00,  1.19it/s]                                                                total_train_epoch 40 epoch_i 0
total_train_epoch 40 epoch_i 1
total_train_epoch 40 epoch_i 2
total_train_epoch 40 epoch_i 3
total_train_epoch 40 epoch_i 4
total_train_epoch 40 epoch_i 5
total_train_epoch 40 epoch_i 6
total_train_epoch 40 epoch_i 7
total_train_epoch 40 epoch_i 8
total_train_epoch 40 epoch_i 9
total_train_epoch 40 epoch_i 10
total_train_epoch 40 epoch_i 11
total_train_epoch 40 epoch_i 12
total_train_epoch 40 epoch_i 13
total_train_epoch 40 epoch_i 14
total_train_epoch 40 epoch_i 15
total_train_epoch 40 epoch_i 16
total_train_epoch 40 epoch_i 17
total_train_epoch 40 epoch_i 18
total_train_epoch 40 epoch_i 19
total_train_epoch 40 epoch_i 20
total_train_epoch 40 epoch_i 21
total_train_epoch 40 epoch_i 22
total_train_epoch 40 epoch_i 23
total_train_epoch 40 epoch_i 24
total_train_epoch 40 epoch_i 25
total_train_epoch 40 epoch_i 26
total_train_epoch 40 epoch_i 27
total_train_epoch 40 epoch_i 28
total_train_epoch 40 epoch_i 29
total_train_epoch 40 epoch_i 30
total_train_epoch 40 epoch_i 31
total_train_epoch 40 epoch_i 32
total_train_epoch 40 epoch_i 33
total_train_epoch 40 epoch_i 34
total_train_epoch 40 epoch_i 35
total_train_epoch 40 epoch_i 36
total_train_epoch 40 epoch_i 37
total_train_epoch 40 epoch_i 38
total_train_epoch 40 epoch_i 39
base training:   0%|          | 0/30 [00:00<?, ?it/s]base training:   3%|▎         | 1/30 [00:01<00:31,  1.08s/it]base training:   7%|▋         | 2/30 [00:02<00:30,  1.09s/it]base training:  10%|█         | 3/30 [00:03<00:30,  1.12s/it]base training:  13%|█▎        | 4/30 [00:04<00:29,  1.12s/it]base training:  17%|█▋        | 5/30 [00:05<00:26,  1.05s/it]base training:  20%|██        | 6/30 [00:06<00:25,  1.05s/it]base training:  23%|██▎       | 7/30 [00:07<00:24,  1.07s/it]base training:  27%|██▋       | 8/30 [00:08<00:23,  1.09s/it]base training:  30%|███       | 9/30 [00:09<00:23,  1.11s/it]base training:  33%|███▎      | 10/30 [00:11<00:22,  1.14s/it]base training:  37%|███▋      | 11/30 [00:12<00:21,  1.14s/it]base training:  40%|████      | 12/30 [00:13<00:20,  1.14s/it]base training:  43%|████▎     | 13/30 [00:14<00:19,  1.15s/it]base training:  47%|████▋     | 14/30 [00:15<00:18,  1.14s/it]base training:  50%|█████     | 15/30 [00:16<00:15,  1.04s/it]base training:  53%|█████▎    | 16/30 [00:17<00:14,  1.03s/it]base training:  57%|█████▋    | 17/30 [00:18<00:13,  1.04s/it]base training:  60%|██████    | 18/30 [00:19<00:10,  1.13it/s]base training:  63%|██████▎   | 19/30 [00:20<00:10,  1.08it/s]base training:  67%|██████▋   | 20/30 [00:21<00:09,  1.00it/s]base training:  70%|███████   | 21/30 [00:21<00:08,  1.07it/s]base training:  73%|███████▎  | 22/30 [00:22<00:07,  1.04it/s]base training:  77%|███████▋  | 23/30 [00:24<00:06,  1.01it/s]base training:  80%|████████  | 24/30 [00:24<00:05,  1.17it/s]base training:  83%|████████▎ | 25/30 [00:25<00:04,  1.10it/s]base training:  87%|████████▋ | 26/30 [00:26<00:03,  1.04it/s]base training:  90%|█████████ | 27/30 [00:27<00:03,  1.01s/it]base training:  93%|█████████▎| 28/30 [00:28<00:02,  1.04s/it]base training:  97%|█████████▋| 29/30 [00:29<00:01,  1.03s/it]base training: 100%|██████████| 30/30 [00:30<00:00,  1.02s/it]                                                              ***********************************************
unique [1, 9]
class: 1
--- num of selected samples: 40
--- num of selected corrupt samples: 40.0
class: 9
--- num of selected samples: 63
--- num of selected corrupt samples: 0.0
***********************************************
clean_idx_len 103
[2, 4, 9, 10, 24, 45, 49, 59, 64, 69, 70, 73, 74, 80, 83, 87, 93, 100, 102, 105, 113, 120, 121, 124, 125, 130, 131, 137, 143, 148, 150, 161, 169, 182, 191, 192, 194, 195, 197, 198, 0, 3, 7, 11, 13, 15, 16, 18, 21, 26, 28, 29, 30, 31, 32, 35, 39, 40, 42, 43, 44, 48, 51, 52, 58, 61, 62, 63, 76, 78, 84, 92, 94, 97, 103, 106, 112, 115, 122, 123, 128, 129, 134, 135, 140, 141, 146, 147, 149, 152, 153, 157, 159, 162, 165, 172, 175, 178, 183, 184, 185, 187, 196]
clean_p
tensor([0.1935, 0.8545, 0.5030, 0.2385, 0.2775, 0.2208, 0.8238, 0.8522, 0.9350,
        0.3413, 0.1619, 0.9443, 0.9227, 0.9283, 0.5525, 0.3920, 0.3683, 0.6025,
        0.1226, 0.8346, 0.7632, 0.2187, 0.2034, 0.7816, 0.8599, 0.9690, 0.8004,
        0.8716, 0.3321, 0.8165, 0.5823, 0.6263, 0.8485, 0.8711, 0.5520, 0.7258,
        0.5502, 0.6587, 0.8499, 0.8229, 0.6144, 0.9521, 0.9023, 0.7408, 0.6486,
        0.9474, 0.8816, 0.0995, 0.7967, 0.9372, 0.5445, 0.3725, 0.8703, 0.9717,
        0.3768, 0.8009, 0.7718, 0.8049, 0.8869, 0.8111, 0.2938, 0.6341, 0.9646,
        0.3014, 0.5956, 0.9077, 0.3504, 0.7316, 0.5683, 0.7953, 0.8041, 0.4003,
        0.0854, 0.8727, 0.4935, 0.4353, 0.2333, 0.4797, 0.3741, 0.9593, 0.8941,
        0.9492, 0.9519, 0.8548, 0.9740, 0.9109, 0.9542, 0.7854, 0.9584, 0.0373,
        0.4839, 0.1467, 0.8821, 0.7862, 0.2450, 0.4293, 0.2037, 0.7121, 0.2819,
        0.8297, 0.9123, 0.5112, 0.8093])
purified buffer update!!
before 67.33333333333333
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 64.66666666666667
before 64.66666666666667
after 64.66666666666667
before 64.66666666666667
after 64.66666666666667
before 64.66666666666667
after 64.66666666666667
before 64.66666666666667
after 64.0
before 64.0
after 64.0
before 64.0
after 64.0
before 64.0
after 64.0
before 64.0
after 64.0
before 64.0
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 63.333333333333336
before 63.333333333333336
after 64.0
before 64.0
after 64.66666666666667
before 64.66666666666667
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 65.33333333333333
before 65.33333333333333
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.0
before 66.0
after 66.66666666666667
before 66.66666666666667
after 66.66666666666667
before 66.66666666666667
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 67.33333333333333
before 67.33333333333333
after 68.0
before 68.0
after 68.0
before 68.0
after 68.0
before 68.0
after 68.66666666666667
before 68.66666666666667
after 68.66666666666667
before 68.66666666666667
after 68.66666666666667
before 68.66666666666667
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
before 69.33333333333333
after 69.33333333333333
#normal data: 104.0, 	 #corrupted data: 46.0
buffer_corrupts tensor(46.)
-------inference SPR------
finetuning:   0%|          | 0/50 [00:00<?, ?it/s]finetuning:   2%|▏         | 1/50 [00:00<00:18,  2.64it/s]finetuning:   4%|▍         | 2/50 [00:00<00:17,  2.72it/s]finetuning:   6%|▌         | 3/50 [00:01<00:17,  2.66it/s]finetuning:   8%|▊         | 4/50 [00:01<00:16,  2.73it/s]finetuning:  10%|█         | 5/50 [00:01<00:17,  2.64it/s]finetuning:  12%|█▏        | 6/50 [00:02<00:16,  2.60it/s]finetuning:  14%|█▍        | 7/50 [00:02<00:17,  2.53it/s]finetuning:  16%|█▌        | 8/50 [00:03<00:16,  2.50it/s]finetuning:  18%|█▊        | 9/50 [00:03<00:16,  2.45it/s]finetuning:  20%|██        | 10/50 [00:03<00:16,  2.40it/s]finetuning:  22%|██▏       | 11/50 [00:04<00:15,  2.47it/s]finetuning:  24%|██▍       | 12/50 [00:04<00:15,  2.49it/s]finetuning:  26%|██▌       | 13/50 [00:05<00:14,  2.52it/s]finetuning:  28%|██▊       | 14/50 [00:05<00:13,  2.61it/s]finetuning:  30%|███       | 15/50 [00:05<00:13,  2.59it/s]finetuning:  32%|███▏      | 16/50 [00:06<00:13,  2.59it/s]finetuning:  34%|███▍      | 17/50 [00:06<00:12,  2.59it/s]finetuning:  36%|███▌      | 18/50 [00:07<00:12,  2.61it/s]finetuning:  38%|███▊      | 19/50 [00:07<00:11,  2.67it/s]finetuning:  40%|████      | 20/50 [00:07<00:11,  2.65it/s]finetuning:  42%|████▏     | 21/50 [00:08<00:11,  2.61it/s]finetuning:  44%|████▍     | 22/50 [00:08<00:10,  2.62it/s]finetuning:  46%|████▌     | 23/50 [00:08<00:10,  2.64it/s]finetuning:  48%|████▊     | 24/50 [00:09<00:09,  2.66it/s]finetuning:  50%|█████     | 25/50 [00:09<00:09,  2.68it/s]finetuning:  52%|█████▏    | 26/50 [00:09<00:08,  2.70it/s]finetuning:  54%|█████▍    | 27/50 [00:10<00:08,  2.67it/s]finetuning:  56%|█████▌    | 28/50 [00:10<00:08,  2.74it/s]finetuning:  58%|█████▊    | 29/50 [00:11<00:07,  2.71it/s]finetuning:  60%|██████    | 30/50 [00:11<00:07,  2.67it/s]finetuning:  62%|██████▏   | 31/50 [00:11<00:07,  2.64it/s]finetuning:  64%|██████▍   | 32/50 [00:12<00:06,  2.62it/s]finetuning:  66%|██████▌   | 33/50 [00:12<00:06,  2.57it/s]finetuning:  68%|██████▊   | 34/50 [00:13<00:06,  2.60it/s]finetuning:  70%|███████   | 35/50 [00:13<00:05,  2.62it/s]finetuning:  72%|███████▏  | 36/50 [00:13<00:05,  2.65it/s]finetuning:  74%|███████▍  | 37/50 [00:14<00:04,  2.68it/s]finetuning:  76%|███████▌  | 38/50 [00:14<00:04,  2.73it/s]finetuning:  78%|███████▊  | 39/50 [00:14<00:03,  2.90it/s]finetuning:  80%|████████  | 40/50 [00:15<00:03,  2.96it/s]finetuning:  82%|████████▏ | 41/50 [00:15<00:03,  2.85it/s]finetuning:  84%|████████▍ | 42/50 [00:15<00:02,  2.81it/s]finetuning:  86%|████████▌ | 43/50 [00:16<00:02,  2.77it/s]finetuning:  88%|████████▊ | 44/50 [00:16<00:02,  2.71it/s]finetuning:  90%|█████████ | 45/50 [00:17<00:01,  2.69it/s]finetuning:  92%|█████████▏| 46/50 [00:17<00:01,  2.69it/s]finetuning:  94%|█████████▍| 47/50 [00:17<00:01,  2.68it/s]finetuning:  96%|█████████▌| 48/50 [00:18<00:00,  2.69it/s]finetuning:  98%|█████████▊| 49/50 [00:18<00:00,  2.70it/s]finetuning: 100%|██████████| 50/50 [00:18<00:00,  2.67it/s]                                                           Traceback (most recent call last):
  File "main.py", line 419, in <module>
    main()
  File "main.py", line 313, in main
    args, cur_labeled_train_datalist, cur_unlabeled_train_datalist, cur_pseudo_test_datalist, cur_noisy_datalist, transform_labeled, transform_unlabeled, transform_test, rm_train_transform, origin)
  File "/home/vision/minhyuk/smh/pseudo_main.py", line 657, in __init__
    self.SPR.spr_train()
  File "/home/vision/minhyuk/smh/spr_main.py", line 111, in spr_train
    train_model(self.config, self.model, self.data_scheduler, self.writer, self.unlabeled_loader, self.noisy_loader, self.origin)
  File "/home/vision/minhyuk/smh/train.py", line 51, in train_model
    purified = model.inference(noisy_loader)
  File "/home/vision/minhyuk/smh/spr_models/SPR.py", line 117, in inference
    idx = data['image_names']
KeyError: 'image_names'
